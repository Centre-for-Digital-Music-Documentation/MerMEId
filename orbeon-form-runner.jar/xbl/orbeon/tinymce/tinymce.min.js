!function(){var t=ORBEON.jQuery,i=(YAHOO.util.Dom,ORBEON.xforms.Events),n=!1;YAHOO.namespace("xbl.fr"),YAHOO.xbl.fr.Tinymce=function(){},ORBEON.xforms.XBL.declareClass(YAHOO.xbl.fr.Tinymce,"xbl-fr-tinymce"),YAHOO.xbl.fr.Tinymce.prototype={"groupElement":null,"visibleInputElement":null,"myEditor":null,"serverValueOutputId":null,"tinymceInitialized":!1,"init":function(){if(!n){var e=t(".tinymce-base-url").attr("href"),r=e.substr(0,e.length-"1b713b2e6d7fd45753f4b8a6270b776e.js".length);tinymce.baseURL=r,n=!0}this.serverValueOutputId=YAHOO.util.Dom.getElementsByClassName("xbl-fr-tinymce-xforms-server-value",null,this.container)[0].id;var o=function(){var t="undefined"!=typeof TINYMCE_CUSTOM_CONFIG?TINYMCE_CUSTOM_CONFIG:YAHOO.xbl.fr.Tinymce.DefaultConfig;return t}.call(this),s=YAHOO.util.Dom.getElementsByClassName("xbl-fr-tinymce-div",null,this.container)[0],a=t(s).attr("tabindex");this.myEditor=new tinymce.Editor(s.id,o,tinymce.EditorManager);var c=ORBEON.xforms.Document.getValue(this.serverValueOutputId);this.onInit(_.bind(function(){this.myEditor.on("blur",_.bind(this._clientToServer,this)),t(this.container).find("a[accesskey]").detach(),this.myEditor.setContent(c);var n=t(this.container).find("iframe");n.contents().on("click",_.bind(function(){this.container.click()},this)),t(n[0].contentWindow).on("focus",_.bind(this.onFocus,this)),_.isUndefined(a)||n.attr("tabindex",a),this.tinymceInitialized=!0,i.componentChangedLayoutEvent.fire()},this));var u=_.bind(function(){if(t(s).is(":visible"))this.myEditor.render();else{var i=ORBEON.util.Properties.internalShortDelay.get();_.delay(u,i)}},this);u()},"_clientToServer":function(){var t=(arguments[0],this.myEditor.getContent());"<div>Â </div>"==t&&(t=""),ORBEON.xforms.Document.dispatchEvent({"targetId":this.container.id,"eventName":"fr-set-client-value","properties":{"fr-value":t}})},"onFocus":function(t){t.target=this.container,i.focus(t)},"hasFocus":function(){var i=t(document.activeElement);return i.parents().is(this.container)||i.parent(".mceListBoxMenu").is("*")},"serverToClient":function(){var t=this.tinymceInitialized&&!this.hasFocus();if(t){var i=ORBEON.xforms.Document.getValue(this.serverValueOutputId);this.myEditor.setContent(i)}},"onInit":function(t){var i=_.bind(t,this);this.tinymceInitialized?i():this.myEditor.on("init",i)},"xformsFocus":function(){this.onInit(function(){this.myEditor.focus()})},"readonly":function(){this.onInit(function(){this.myEditor.getBody().contentEditable=!1})},"readwrite":function(){this.onInit(function(){this.myEditor.getBody().contentEditable=!0})}}}();
//# sourceMappingURL=tinymce.min.js.map