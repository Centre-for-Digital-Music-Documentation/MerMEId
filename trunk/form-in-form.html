<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>javascrkipt for publishing interface</title>
    <meta http-equiv="Content-Type"
	  content="text/html;charset=UTF-8"/>

    <script type="text/javascript">
      //<![CDATA[

      function show_confirm(formid,text)
      {
         var r=confirm("Do you really want to delete the file '" 
         + text +"'?" );
         if (r==true) {
            var form = document.getElementById(formid);
            form.submit();
         } else {
         }
      }

      function add_publish(formid,inputid,checkbox)
      {
      	 var formdiv   = document.getElementById('publish');
         var localform = document.getElementById(formid);
         var input     = document.getElementById(inputid);

	 if(checkbox.checked == false) {
	    localform.insertBefore(input,getFirstChild(localform));
            input.setAttribute('type','hidden');
         } else {
	    input.setAttribute('type',"text");
            formdiv.appendChild(input);
         }
      }

      function check_all()
      {
        var inputs = new Array();  
	inputs = document.getElementsByTagName("input");  

	for(var i = 0; i < inputs.length ; i++) {
	    var input = inputs[i];
	    if(input.type=="checkbox" && input.title=="publish") {
	       if(input.checked==false) {
	          input.checked=true;
		  var parentId=input.parentNode.id;
		  var dataId=getFirstChild(input.parentNode).id;
		  add_publish(parentId,dataId,input)
               }
	    } 
	 }
      }

      function getFirstChild(parent){
	 for(var i = 0; i < parent.childNodes.length; i++ ) {
	    if( parent.childNodes[i].nodeName == 'INPUT' ) {
		        return  parent.childNodes[i];
            }
         }
      }
      //]]>
    </script>


  </head>
  <body>

    <p>Up here is a more or less hidden form. Just a publish button is
    visible.</p>

    <form method="get" action="http://test-publish/" >
      <div id="publish">

     <input type="submit" 
	       name="publish" 
	       value="publish selected files" />

	<input 
	    onclick="check_all();return false;"
	    type="button" 
	    name="publish" 
	    value="check all records" />

	
      </div>
    </form>

    <form action="" >
      <div id="check">

	
      </div>
    </form>



    <p>Here we have a list of documents in eXist</p>

    <ul>
      <li>cnw0096.xml <form id="formcnw0096.xml" 
		action="file://disdev-01.kb.dk/filter/delete/dcm/cnw0096.xml" 
		method="post" style="display:inline;">

	<div id="sourcedivcnw0096.xml" 	style="display:inline;">

	  <input id="sourcecnw0096.xml" 
		 type="hidden" 
		 value="publish" 
		 name="http://disdev-01.kb.dk/storage/dcm/cnw0096.xml" 
		 title="file name"/>

	  <input 
	      type="hidden" 
	      name="file" 
	      value="disdev-01.kb.dk/storage/dcm/cnw0096.xml" 
	      title="file"/>

	  <input onclick="show_confirm('formcnw0096.xml',
			  '29 små præludier for orgel eller harmonium');return false;" 
		 type="image" 
		 src="http://disdev-01.kb.dk//editor/images/delete.gif" 
		 name="button" 
		 value="delete" 
		 title="Delete"/>

	  <input onclick="add_publish('sourcedivcnw0096.xml',
			   'sourcecnw0096.xml',this);" 
		 type="checkbox" 
		 name="button" 
		 value="" 
		 title="publish"/>

	</div>

      </form>
      </li>

      <li>cnw0097.xml <form id="formcnw0097.xml" 
		action="file://disdev-01.kb.dk/filter/delete/dcm/cnw0096.xml" 
		method="post" style="display:inline;">

	<div id="sourcedivcnw0097.xml" 	style="display:inline;">

	  <input id="sourcecnw0097.xml" 
		 type="hidden" 
		 value="publish" 
		 name="http://disdev-01.kb.dk/storage/dcm/cnw0096.xml" 
		 title="file name"/>

	  <input 
	      type="hidden" 
	      name="file" 
	      value="disdev-01.kb.dk/storage/dcm/cnw0096.xml" 
	      title="file name"/>

	  <input onclick="show_confirm('formcnw0097.xml',
			  '29 små præludier for orgel eller harmonium');return false;" 
		 type="image" 
		 src="http://disdev-01.kb.dk//editor/images/delete.gif" 
		 name="button" 
		 value="delete" 
		 title="Delete"/>

	  <input onclick="add_publish('sourcedivcnw0097.xml',
			   'sourcecnw0097.xml',this);" 
		 type="checkbox" 
		 name="button" 
		 value="" 
		 title="publish"/>

	</div>

      </form>

      </li>
      <li>
	cnw0098.xml
	<form id="formcnw0098.xml" 
	      action="file://disdev-01.kb.dk/filter/delete/dcm/cnw0096.xml" 
	      method="post" style="display:inline;">

	  <div id="sourcedivcnw0098.xml" style="display:inline;">

	    <input id="sourcecnw0098.xml" 
		   type="hidden" 
		   value="publish" 
		   name="http://disdev-01.kb.dk/storage/dcm/cnw0096.xml" 
		   title="file name"/>

	    <input 
		type="hidden" 
		name="file" 
		value="disdev-01.kb.dk/storage/dcm/cnw0096.xml" 
		title="file name"/>

	    <input onclick="show_confirm('formcnw0098.xml',
			    '29 små præludier for orgel eller harmonium');return false;" 
		   type="image" 
		   src="http://disdev-01.kb.dk//editor/images/delete.gif" 
		   name="button" 
		   value="delete" 
		   title="Delete"/>

	    <input onclick="add_publish('sourcedivcnw0098.xml',
			     'sourcecnw0098.xml',this);" 
		   type="checkbox" 
		   name="button" 
		   value="cnw0098.xml" 
		   title="publish"/>

	  </div>

	</form>
      </li>
    </ul>


  </body>
</html>
